<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-triage Web Application - Demo Version</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 10px;
            padding: 5px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .nav-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            background: transparent;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .hidden {
            display: none;
        }

        /* Dashboard Styles */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.1;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="white"/><circle cx="80" cy="20" r="2" fill="white"/><circle cx="20" cy="80" r="2" fill="white"/><circle cx="80" cy="80" r="2" fill="white"/></svg>');
        }

        .critical { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .urgent { background: linear-gradient(135deg, #f39c12, #e67e22); }
        .semi-urgent { background: linear-gradient(135deg, #f1c40f, #f39c12); }
        .non-urgent { background: linear-gradient(135deg, #27ae60, #2ecc71); }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }

        /* Patient List */
        .patient-list {
            max-height: 500px;
            overflow-y: auto;
        }

        .patient-card {
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .patient-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .priority-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            color: white;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .priority-1 { background: #e74c3c; }
        .priority-2 { background: #f39c12; }
        .priority-3 { background: #f1c40f; color: #333; }
        .priority-4 { background: #27ae60; }

        /* Assessment Form */
        .symptom-check {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .symptom-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .symptom-item input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }

        /* Alert */
        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üè• E-triage Web Application</h1>
            <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå</p>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('dashboard')">üìä Dashboard</button>
            <button class="nav-tab" onclick="showTab('register')">üë§ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</button>
            <button class="nav-tab" onclick="showTab('assessment')">ü©∫ ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô Triage</button>
            <button class="nav-tab" onclick="showTab('patients')">üìã ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content">
            <h2>üìä Dashboard - ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</h2>
            
            <div class="stats-grid">
                <div class="stat-card critical">
                    <div class="stat-number" id="critical-count">0</div>
                    <div class="stat-label">üî¥ Critical (‡∏ß‡∏¥‡∏Å‡∏§‡∏ï)</div>
                </div>
                <div class="stat-card urgent">
                    <div class="stat-number" id="urgent-count">0</div>
                    <div class="stat-label">üü† Urgent (‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô)</div>
                </div>
                <div class="stat-card semi-urgent">
                    <div class="stat-number" id="semi-urgent-count">0</div>
                    <div class="stat-label">üü° Semi-urgent (‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô)</div>
                </div>
                <div class="stat-card non-urgent">
                    <div class="stat-number" id="non-urgent-count">0</div>
                    <div class="stat-label">üü¢ Non-urgent (‡πÑ‡∏°‡πà‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô)</div>
                </div>
            </div>

            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                <h3>‚ÑπÔ∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
                <p><strong>‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</strong> <span id="total-patients">0</span> ‡∏Ñ‡∏ô</p>
                <p><strong>‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏´‡∏°‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ:</strong> <span id="today-patients">0</span> ‡∏Ñ‡∏ô</p>
                <p><strong>‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:</strong> <span id="current-time"></span></p>
            </div>
        </div>

        <!-- Register Patient Tab -->
        <div id="register" class="tab-content hidden">
            <h2>üë§ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏´‡∏°‡πà</h2>
            
            <form id="patient-form">
                <div class="form-group">
                    <label for="patient-name">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
                    <input type="text" id="patient-name" required>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label for="patient-age">‡∏≠‡∏≤‡∏¢‡∏∏ *</label>
                        <input type="number" id="patient-age" min="0" max="120" required>
                    </div>
                    <div class="form-group">
                        <label for="patient-gender">‡πÄ‡∏û‡∏® *</label>
                        <select id="patient-gender" required>
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏®</option>
                            <option value="male">‡∏ä‡∏≤‡∏¢</option>
                            <option value="female">‡∏´‡∏ç‡∏¥‡∏á</option>
                            <option value="other">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="patient-phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                    <input type="tel" id="patient-phone">
                </div>

                <div class="form-group">
                    <label for="patient-id">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô/Passport</label>
                    <input type="text" id="patient-id">
                </div>

                <div class="form-group">
                    <label for="chief-complaint">‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå *</label>
                    <textarea id="chief-complaint" rows="3" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏ß‡∏î‡∏ó‡πâ‡∏≠‡∏á, ‡πÑ‡∏Ç‡πâ‡∏™‡∏π‡∏á, ‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏•‡∏≥‡∏ö‡∏≤‡∏Å..."></textarea>
                </div>

                <button type="submit" class="btn btn-primary">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</button>
            </form>
        </div>

        <!-- Triage Assessment Tab -->
        <div id="assessment" class="tab-content hidden">
            <h2>ü©∫ ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô Triage</h2>
            
            <form id="triage-form">
                <div class="form-group">
                    <label for="assess-patient">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ *</label>
                    <select id="assess-patient" required>
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</option>
                    </select>
                </div>

                <h3>üå°Ô∏è ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏ä‡∏µ‡∏û</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div class="form-group">
                        <label for="blood-pressure">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï (mmHg)</label>
                        <input type="text" id="blood-pressure" placeholder="120/80">
                    </div>
                    <div class="form-group">
                        <label for="heart-rate">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡πâ‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à (bpm)</label>
                        <input type="number" id="heart-rate" placeholder="72">
                    </div>
                    <div class="form-group">
                        <label for="temperature">‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢ (¬∞C)</label>
                        <input type="number" id="temperature" step="0.1" placeholder="37.0">
                    </div>
                    <div class="form-group">
                        <label for="oxygen-sat">‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î (%)</label>
                        <input type="number" id="oxygen-sat" min="0" max="100" placeholder="98">
                    </div>
                </div>

                <h3>‚ö†Ô∏è ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏†‡∏±‡∏¢</h3>
                <div class="symptom-check">
                    <div class="symptom-item">
                        <input type="checkbox" id="unconscious" value="unconscious">
                        <label for="unconscious">‡∏´‡∏°‡∏î‡∏™‡∏ï‡∏¥/‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ï‡∏±‡∏ß</label>
                    </div>
                    <div class="symptom-item">
                        <input type="checkbox" id="chest-pain" value="chest-pain">
                        <label for="chest-pain">‡πÄ‡∏à‡πá‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏Å‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á</label>
                    </div>
                    <div class="symptom-item">
                        <input type="checkbox" id="breathing-difficulty" value="breathing-difficulty">
                        <label for="breathing-difficulty">‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏•‡∏≥‡∏ö‡∏≤‡∏Å‡∏°‡∏≤‡∏Å</label>
                    </div>
                    <div class="symptom-item">
                        <input type="checkbox" id="severe-bleeding" value="severe-bleeding">
                        <label for="severe-bleeding">‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏Å</label>
                    </div>
                    <div class="symptom-item">
                        <input type="checkbox" id="high-fever" value="high-fever">
                        <label for="high-fever">‡πÑ‡∏Ç‡πâ‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å (>39¬∞C)</label>
                    </div>
                    <div class="symptom-item">
                        <input type="checkbox" id="severe-pain" value="severe-pain">
                        <label for="severe-pain">‡∏õ‡∏ß‡∏î‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡∏°‡∏≤‡∏Å (8-10/10)</label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="pain-score">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏ß‡∏î (0-10)</label>
                    <select id="pain-score">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏ß‡∏î</option>
                        <option value="0">0 - ‡πÑ‡∏°‡πà‡∏õ‡∏ß‡∏î‡πÄ‡∏•‡∏¢</option>
                        <option value="1">1 - ‡∏õ‡∏ß‡∏î‡∏ô‡πâ‡∏≠‡∏¢‡∏°‡∏≤‡∏Å</option>
                        <option value="2">2 - ‡∏õ‡∏ß‡∏î‡∏ô‡πâ‡∏≠‡∏¢</option>
                        <option value="3">3 - ‡∏õ‡∏ß‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢</option>
                        <option value="4">4 - ‡∏õ‡∏ß‡∏î‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
                        <option value="5">5 - ‡∏õ‡∏ß‡∏î‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏°‡∏≤‡∏Å</option>
                        <option value="6">6 - ‡∏õ‡∏ß‡∏î‡∏°‡∏≤‡∏Å</option>
                        <option value="7">7 - ‡∏õ‡∏ß‡∏î‡∏°‡∏≤‡∏Å‡∏°‡∏≤‡∏¢</option>
                        <option value="8">8 - ‡∏õ‡∏ß‡∏î‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á</option>
                        <option value="9">9 - ‡∏õ‡∏ß‡∏î‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡∏°‡∏≤‡∏Å</option>
                        <option value="10">10 - ‡∏õ‡∏ß‡∏î‡∏™‡∏∏‡∏î‡∏Ç‡∏µ‡∏î</option>
                    </select>
                </div>

                <button type="button" class="btn btn-success" onclick="calculateTriage()">üîç ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Triage Priority</button>
            </form>

            <div id="triage-result" style="margin-top: 20px;"></div>
        </div>

        <!-- Patient List Tab -->
        <div id="patients" class="tab-content hidden">
            <h2>üìã ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
            
            <div style="margin-bottom: 20px;">
                <input type="text" id="search-patient" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢..." style="width: 300px; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                <select id="filter-priority" style="padding: 10px; margin-left: 10px;">
                    <option value="">‡∏ó‡∏∏‡∏Å Priority</option>
                    <option value="1">üî¥ Critical</option>
                    <option value="2">üü† Urgent</option>
                    <option value="3">üü° Semi-urgent</option>
                    <option value="4">üü¢ Non-urgent</option>
                </select>
                <button class="btn btn-danger" onclick="clearAllData()" style="margin-left: 10px;">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
            </div>

            <div id="patient-list" class="patient-list">
                <!-- Patient cards will be inserted here -->
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let patients = [];
        let currentPatientId = null;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadPatients();
            updateDashboard();
            updatePatientList();
            updatePatientSelect();
            updateCurrentTime();
            
            // Update time every second
            setInterval(updateCurrentTime, 1000);

            // Add event listeners
            document.getElementById('patient-form').addEventListener('submit', handlePatientRegistration);
            document.getElementById('search-patient').addEventListener('input', filterPatients);
            document.getElementById('filter-priority').addEventListener('change', filterPatients);
        });

        // Tab switching
        function showTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.add('hidden'));
            
            // Remove active class from all nav tabs
            const navTabs = document.querySelectorAll('.nav-tab');
            navTabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabName).classList.remove('hidden');
            event.target.classList.add('active');
            
            // Update data when switching to certain tabs
            if (tabName === 'dashboard') {
                updateDashboard();
            } else if (tabName === 'patients') {
                updatePatientList();
            }
        }

        // Patient Registration
        function handlePatientRegistration(e) {
            e.preventDefault();
            
            const patient = {
                id: Date.now(),
                name: document.getElementById('patient-name').value,
                age: document.getElementById('patient-age').value,
                gender: document.getElementById('patient-gender').value,
                phone: document.getElementById('patient-phone').value,
                idNumber: document.getElementById('patient-id').value,
                chiefComplaint: document.getElementById('chief-complaint').value,
                registrationTime: new Date().toISOString(),
                priority: null,
                triageCompleted: false
            };

            patients.push(patient);
            savePatients();
            
            // Show success message
            showAlert('success', `‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ "${patient.name}" ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß`);
            
            // Reset form
            document.getElementById('patient-form').reset();
            
            // Update displays
            updateDashboard();
            updatePatientSelect();
        }

        // Triage Assessment
        function calculateTriage() {
            const patientId = document.getElementById('assess-patient').value;
            if (!patientId) {
                showAlert('danger', '‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô');
                return;
            }

            const patient = patients.find(p => p.id == patientId);
            if (!patient) return;

            // Get vital signs
            const bloodPressure = document.getElementById('blood-pressure').value;
            const heartRate = parseInt(document.getElementById('heart-rate').value);
            const temperature = parseFloat(document.getElementById('temperature').value);
            const oxygenSat = parseInt(document.getElementById('oxygen-sat').value);
            const painScore = parseInt(document.getElementById('pain-score').value);

            // Get warning symptoms
            const symptoms = [];
            document.querySelectorAll('.symptom-check input[type="checkbox"]:checked').forEach(cb => {
                symptoms.push(cb.value);
            });

            // Calculate priority
            let priority = 4; // Default: Non-urgent
            let priorityText = 'Non-urgent';
            let priorityColor = '#27ae60';
            let recommendations = [];

            // Critical conditions (Priority 1)
            if (symptoms.includes('unconscious') || 
                oxygenSat < 85 || 
                heartRate > 120 || heartRate < 50 ||
                temperature > 40 ||
                symptoms.includes('severe-bleeding') ||
                symptoms.includes('chest-pain') ||
                symptoms.includes('breathing-difficulty')) {
                
                priority = 1;
                priorityText = 'Critical (‡∏ß‡∏¥‡∏Å‡∏§‡∏ï)';
                priorityColor = '#e74c3c';
                recommendations.push('üö® ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ó‡∏±‡∏ô‡∏ó‡∏µ');
                recommendations.push('üìû ‡πÅ‡∏à‡πâ‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏ß‡∏£‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô');
            }
            // Urgent conditions (Priority 2)
            else if (painScore >= 8 || 
                     temperature > 39 || 
                     oxygenSat < 92 ||
                     heartRate > 100 ||
                     symptoms.includes('high-fever') ||
                     symptoms.includes('severe-pain')) {
                
                priority = 2;
                priorityText = 'Urgent (‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô)';
                priorityColor = '#f39c12';
                recommendations.push('‚ö° ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 30 ‡∏ô‡∏≤‡∏ó‡∏µ');
                recommendations.push('ü©∫ ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°');
            }
            // Semi-urgent conditions (Priority 3)
            else if (painScore >= 5 || 
                     temperature > 38.5 ||
                     heartRate > 90) {
                
                priority = 3;
                priorityText = 'Semi-urgent (‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô)';
                priorityColor = '#f1c40f';
                recommendations.push('‚è∞ ‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á');
                recommendations.push('üìã ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞');
            }

            // Update patient data
            patient.priority = priority;
            patient.triageCompleted = true;
            patient.triageTime = new Date().toISOString();
            patient.vitalSigns = {
                bloodPressure,
                heartRate,
                temperature,
                oxygenSat,
                painScore
            };
            patient.symptoms = symptoms;

            savePatients();

            // Display result
            const resultDiv = document.getElementById('triage-result');
            resultDiv.innerHTML = `
                <div class="alert alert-success">
                    <h3>üéØ ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô Triage</h3>
                    <div style="background: ${priorityColor}; color: white; padding: 15px; border-radius: 8px; margin: 15px 0;">
                        <h4>Priority Level ${priority}: ${priorityText}</h4>
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <h4>üìù ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</h4>
                        <ul>
                            ${recommendations.map(rec => `<li>${rec}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `;

            // Update displays
            updateDashboard();
            updatePatientList();
            
            showAlert('success', `‚úÖ ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô Triage ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "${patient.name}" ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô`);
        }

        // Update Dashboard
        function updateDashboard() {
            const criticalCount = patients.filter(p => p.priority === 1).length;
            const urgentCount = patients.filter(p => p.priority === 2).length;
            const semiUrgentCount = patients.filter(p => p.priority === 3).length;
            const nonUrgentCount = patients.filter(p => p.priority === 4).length;

            document.getElementById('critical-count').textContent = criticalCount;
            document.getElementById('urgent-count').textContent = urgentCount;
            document.getElementById('semi-urgent-count').textContent = semiUrgentCount;
            document.getElementById('non-urgent-count').textContent = nonUrgentCount;
            document.getElementById('total-patients').textContent = patients.length;

            // Count today's patients
            const today = new Date().toDateString();
            const todayPatients = patients.filter(p => new Date(p.registrationTime).toDateString() === today).length;
            document.getElementById('today-patients').textContent = todayPatients;
        }

        // Update Patient List
        function updatePatientList() {
            const listDiv = document.getElementById('patient-list');
            
            if (patients.length === 0) {
                listDiv.innerHTML = '<div style="text-align: center; padding: 40px; color: #7f8c8d;"><h3>üìù ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</h3><p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πá‡∏ö "‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏´‡∏°‡πà</p></div>';
                return;
            }

            // Sort by priority (critical first) and registration time
            const sortedPatients = [...patients].sort((a, b) => {
                if (a.priority && b.priority) {
                    if (a.priority !== b.priority) return a.priority - b.priority;
                }
                return new Date(b.registrationTime) - new Date(a.registrationTime);
            });

            listDiv.innerHTML = sortedPatients.map(patient => {
                const priorityClass = patient.priority ? `priority-${patient.priority}` : '';
                const priorityText = getPriorityText(patient.priority);
                const regTime = new Date(patient.registrationTime).toLocaleString('th-TH');
                
                return `
                    <div class="patient-card">
                        ${patient.priority ? `<div class="priority-badge ${priorityClass}">${priorityText}</div>` : '<div class="priority-badge" style="background: #95a5a6;">‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</div>'}
                        <h4>${patient.name}</h4>
                        <p><strong>‡∏≠‡∏≤‡∏¢‡∏∏:</strong> ${patient.age} ‡∏õ‡∏µ | <strong>‡πÄ‡∏û‡∏®:</strong> ${getGenderText(patient.gender)}</p>
                        <p><strong>‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å:</strong> ${patient.chiefComplaint}</p>
                        <p><strong>‡πÄ‡∏ß‡∏•‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô:</strong> ${regTime}</p>
                        ${patient.phone ? `<p><strong>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</strong> ${patient.phone}</p>` : ''}
                        <div style="margin-top: 10px;">
                            <button class="btn btn-primary" onclick="editPatient(${patient.id})">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                            <button class="btn btn-danger" onclick="deletePatient(${patient.id})">üóëÔ∏è ‡∏•‡∏ö</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Update Patient Select for Assessment
        function updatePatientSelect() {
            const select = document.getElementById('assess-patient');
            select.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</option>';
            
            patients.forEach(patient => {
                const option = document.createElement('option');
                option.value = patient.id;
                option.textContent = `${patient.name} (${patient.age} ‡∏õ‡∏µ) - ${patient.chiefComplaint}`;
                select.appendChild(option);
            });
        }

        // Helper functions
        function getPriorityText(priority) {
            switch(priority) {
                case 1: return 'üî¥ Critical';
                case 2: return 'üü† Urgent';
                case 3: return 'üü° Semi-urgent';
                case 4: return 'üü¢ Non-urgent';
                default: return '‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô';
            }
        }

        function getGenderText(gender) {
            switch(gender) {
                case 'male': return '‡∏ä‡∏≤‡∏¢';
                case 'female': return '‡∏´‡∏ç‡∏¥‡∏á';
                default: return '‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
            }
        }

        // Filter patients
        function filterPatients() {
            const searchTerm = document.getElementById('search-patient').value.toLowerCase();
            const filterPriority = document.getElementById('filter-priority').value;
            
            const filteredPatients = patients.filter(patient => {
                const matchesSearch = patient.name.toLowerCase().includes(searchTerm) ||
                                    patient.chiefComplaint.toLowerCase().includes(searchTerm);
                const matchesPriority = !filterPriority || patient.priority == filterPriority;
                
                return matchesSearch && matchesPriority;
            });

            displayFilteredPatients(filteredPatients);
        }

        function displayFilteredPatients(filteredPatients) {
            const listDiv = document.getElementById('patient-list');
            
            if (filteredPatients.length === 0) {
                listDiv.innerHTML = '<div style="text-align: center; padding: 40px; color: #7f8c8d;"><h3>üîç ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3></div>';
                return;
            }

            listDiv.innerHTML = filteredPatients.map(patient => {
                const priorityClass = patient.priority ? `priority-${patient.priority}` : '';
                const priorityText = getPriorityText(patient.priority);
                const regTime = new Date(patient.registrationTime).toLocaleString('th-TH');
                
                return `
                    <div class="patient-card">
                        ${patient.priority ? `<div class="priority-badge ${priorityClass}">${priorityText}</div>` : '<div class="priority-badge" style="background: #95a5a6;">‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</div>'}
                        <h4>${patient.name}</h4>
                        <p><strong>‡∏≠‡∏≤‡∏¢‡∏∏:</strong> ${patient.age} ‡∏õ‡∏µ | <strong>‡πÄ‡∏û‡∏®:</strong> ${getGenderText(patient.gender)}</p>
                        <p><strong>‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å:</strong> ${patient.chiefComplaint}</p>
                        <p><strong>‡πÄ‡∏ß‡∏•‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô:</strong> ${regTime}</p>
                        ${patient.phone ? `<p><strong>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</strong> ${patient.phone}</p>` : ''}
                        <div style="margin-top: 10px;">
                            <button class="btn btn-primary" onclick="editPatient(${patient.id})">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                            <button class="btn btn-danger" onclick="deletePatient(${patient.id})">üóëÔ∏è ‡∏•‡∏ö</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Patient management
        function editPatient(id) {
            const patient = patients.find(p => p.id === id);
            if (!patient) return;

            // Switch to register tab and fill form
            showTab('register');
            document.querySelector('[onclick="showTab(\'register\')"]').click();
            
            document.getElementById('patient-name').value = patient.name;
            document.getElementById('patient-age').value = patient.age;
            document.getElementById('patient-gender').value = patient.gender;
            document.getElementById('patient-phone').value = patient.phone || '';
            document.getElementById('patient-id').value = patient.idNumber || '';
            document.getElementById('chief-complaint').value = patient.chiefComplaint;
            
            // Store current editing ID
            currentPatientId = id;
            
            // Change button text
            const submitBtn = document.querySelector('#patient-form button[type="submit"]');
            submitBtn.textContent = '‚úÖ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢';
            
            showAlert('success', `üìù ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á "${patient.name}"`);
        }

        function deletePatient(id) {
            const patient = patients.find(p => p.id === id);
            if (!patient) return;

            if (confirm(`‚ùå ‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á "${patient.name}"?`)) {
                patients = patients.filter(p => p.id !== id);
                savePatients();
                updateDashboard();
                updatePatientList();
                updatePatientSelect();
                showAlert('success', `üóëÔ∏è ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á "${patient.name}" ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß`);
            }
        }

        // Clear all data
        function clearAllData() {
            if (confirm('‚ö†Ô∏è ‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ!')) {
                patients = [];
                savePatients();
                updateDashboard();
                updatePatientList();
                updatePatientSelect();
                showAlert('success', 'üßπ ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            }
        }

        // Update current time
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleString('th-TH');
            document.getElementById('current-time').textContent = timeString;
        }

        // Show alert message
        function showAlert(type, message) {
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.textContent = message;
            
            // Insert at top of page
            const container = document.querySelector('.container');
            container.insertBefore(alert, container.firstChild);
            
            // Remove after 5 seconds
            setTimeout(() => {
                alert.remove();
            }, 5000);
        }

        // Data persistence
        function savePatients() {
            localStorage.setItem('e-triage-patients', JSON.stringify(patients));
        }

        function loadPatients() {
            const saved = localStorage.getItem('e-triage-patients');
            if (saved) {
                patients = JSON.parse(saved);
            }
        }

        // Handle form update vs create
        document.getElementById('patient-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (currentPatientId) {
                // Update existing patient
                const patient = patients.find(p => p.id === currentPatientId);
                if (patient) {
                    patient.name = document.getElementById('patient-name').value;
                    patient.age = document.getElementById('patient-age').value;
                    patient.gender = document.getElementById('patient-gender').value;
                    patient.phone = document.getElementById('patient-phone').value;
                    patient.idNumber = document.getElementById('patient-id').value;
                    patient.chiefComplaint = document.getElementById('chief-complaint').value;
                    
                    savePatients();
                    showAlert('success', `‚úÖ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á "${patient.name}" ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß`);
                    
                    // Reset form and button
                    document.getElementById('patient-form').reset();
                    document.querySelector('#patient-form button[type="submit"]').textContent = 'üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢';
                    currentPatientId = null;
                    
                    updateDashboard();
                    updatePatientList();
                    updatePatientSelect();
                }
            } else {
                // Handle new patient registration (existing code)
                handlePatientRegistration(e);
            }
        });
    </script>
</body>
</html>

